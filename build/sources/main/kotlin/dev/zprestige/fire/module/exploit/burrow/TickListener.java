package dev.zprestige.fire.module.exploit.burrow;

import dev.zprestige.fire.Main;
import dev.zprestige.fire.event.bus.EventListener;
import dev.zprestige.fire.event.impl.TickEvent;

import java.util.Arrays;

public class TickListener extends EventListener<TickEvent, Burrow> {

    public TickListener(final Burrow burrow) {
        super(TickEvent.class, burrow);
    }

    @Override
    public void invoke(final Object object) {
        final int slot = module.slot();
        if (slot == -1) {
            module.disableModule();
            return;
        }
        Arrays.stream(module.offsets).forEach(offset -> module.sendPackets(offset));
        Main.interactionManager.placeBlockWithSwitchIgnoringEntities(module.startPos, module.rotate.GetSwitch(), true, false, slot);
        module.sendPacketsOnGround(module.force.GetSlider());
        module.disableModule();
    }
}
