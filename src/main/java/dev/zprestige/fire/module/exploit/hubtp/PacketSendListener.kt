package dev.zprestige.fire.module.exploit.hubtp

import dev.zprestige.fire.event.bus.EventListener
import dev.zprestige.fire.event.impl.PacketEvent.PacketSendEvent
import net.minecraft.network.play.client.CPacketConfirmTeleport
import net.minecraft.network.play.client.CPacketPlayer
import net.minecraft.network.play.client.CPacketPlayer.PositionRotation

class PacketSendListener(hubTP: HubTP) : EventListener<PacketSendEvent, HubTP>(
    PacketSendEvent::class.java, hubTP
) {
    override fun invoke(e: Any) {
        val event = e as PacketSendEvent
        if (event.packet is CPacketPlayer.Position || event.packet is PositionRotation) {
            val packet = event.packet as CPacketPlayer
            packet.y += 0.30
        }
        if (event.packet is CPacketConfirmTeleport) {
            val packet = event.packet as CPacketConfirmTeleport
            module.teleportId = packet.teleportId
        }
    }
}