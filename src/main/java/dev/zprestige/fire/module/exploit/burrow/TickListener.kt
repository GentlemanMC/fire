package dev.zprestige.fire.module.exploit.burrow

import dev.zprestige.fire.Main
import dev.zprestige.fire.event.bus.EventListener
import dev.zprestige.fire.event.impl.TickEvent
import java.util.*

class TickListener(burrow: Burrow) : EventListener<TickEvent, Burrow>(TickEvent::class.java, burrow) {
    
    override fun invoke(e: Any) {
        val slot = module.slot()
        if (slot == -1) {
            module.disableModule()
            return
        }
        Arrays.stream(module.offsets).forEach { offset: Double ->
            module.sendPackets(offset)
        }
        Main.interactionManager.placeBlockWithSwitchIgnoringEntities(module.startPos,
            module.rotate.GetSwitch(),
            true,
            false,
            slot
        )
        module.sendPacketsOnGround(module.force.GetSlider().toDouble())
        module.disableModule()
    }
}
