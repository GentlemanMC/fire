package dev.zprestige.fire.module.exploit.chorusmanipulator

import dev.zprestige.fire.Main
import dev.zprestige.fire.event.bus.EventListener
import dev.zprestige.fire.event.impl.TickEvent
import net.minecraft.init.Items
import org.lwjgl.input.Keyboard

class TickListener(chorusManipulator: ChorusManipulator) : EventListener<TickEvent, ChorusManipulator>(
    TickEvent::class.java, chorusManipulator
) {
    override fun invoke(e: Any) {
        if (!(mc.player.heldItemMainhand.getItem().equals(Items.CHORUS_FRUIT) && mc.gameSettings.keyBindUseItem.isKeyDown)) {
            module.timer.syncTime()
        }
        if (module.timer.getTime(500)) {
            module.chorussed = true
        }
        if (module.chorussed && Keyboard.isKeyDown(module.activateKey.GetKey())) {
            module.activate()
            Main.chatManager.sendRemovableMessage("Teleported to chorus position", 1)
        }
    }
}