package dev.zprestige.fire.module.exploit.burrow;

import dev.zprestige.fire.Main;
import dev.zprestige.fire.event.bus.EventListener;
import dev.zprestige.fire.module.Descriptor;
import dev.zprestige.fire.module.Module;
import dev.zprestige.fire.settings.impl.ComboBox;
import dev.zprestige.fire.settings.impl.Slider;
import dev.zprestige.fire.settings.impl.Switch;
import dev.zprestige.fire.util.impl.BlockUtil;
import net.minecraft.init.Blocks;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.util.math.BlockPos;

@Descriptor(description = "Rubberbands you inside a block (Skitttyyhack)")
public class Burrow extends Module {
    public final Slider force = Menu.Slider("Force", 2.0f, -5.0f, 5.0f);
    public final Switch rotate = Menu.Switch("Rotate", false);
    public final Switch strict = Menu.Switch("Strict", false);
    public final ComboBox block = Menu.ComboBox("Block", "Fallback", new String[]{
            "Obsidian", "EnderChests", "Fallback", "ReverseFallback", "WitherSkulls", "Anvil", "Webs"
    });
    protected final double[] offsets = new double[]{
            0.41999998688698,
            0.7531999805211997,
            1.00133597911214,
            1.16610926093821
    };
    protected BlockPos startPos;

    public Burrow() {
        eventListeners = new EventListener[]{
                new TickListener(this)
        };
    }

    @Override
    public void onEnable() {
        startPos = BlockUtil.getPosition();
    }

    protected void sendPacketsOnGround(final double y) {
        mc.player.connection.sendPacket(new CPacketPlayer.Position(mc.player.posX, mc.player.posY + y, mc.player.posZ, false));
    }

    protected void sendPackets(final double y) {
        mc.player.connection.sendPacket(new CPacketPlayer.Position(mc.player.posX, mc.player.posY + y, mc.player.posZ, true));
    }

    protected int slot() {
        switch (block.GetCombo()) {
            case "Obsidian":
                return Main.inventoryManager.getBlockFromHotbar(Blocks.OBSIDIAN);
            case "EnderChests":
                return Main.inventoryManager.getBlockFromHotbar(Blocks.ENDER_CHEST);
            case "Fallback":
                int slot3 = Main.inventoryManager.getBlockFromHotbar(Blocks.ENDER_CHEST);
                if (slot3 != -1) {
                    return slot3;
                } else {
                    return Main.inventoryManager.getBlockFromHotbar(Blocks.OBSIDIAN);
                }
            case "ReverseFallback":
                int slot2 = Main.inventoryManager.getBlockFromHotbar(Blocks.OBSIDIAN);
                if (slot2 != -1) {
                    return slot2;
                } else {
                    return Main.inventoryManager.getBlockFromHotbar(Blocks.ENDER_CHEST);
                }
            case "WitherSkulls":
                return Main.inventoryManager.getBlockFromHotbar(Blocks.SKULL);
            case "Anvil":
                return Main.inventoryManager.getBlockFromHotbar(Blocks.ANVIL);
            case "Webs":
                return Main.inventoryManager.getBlockFromHotbar(Blocks.WEB);
        }
        return -1;
    }
}