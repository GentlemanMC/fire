package dev.zprestige.fire.module.exploit.chorusmanipulator;

import dev.zprestige.fire.Main;
import dev.zprestige.fire.event.bus.EventListener;
import dev.zprestige.fire.event.impl.TickEvent;
import net.minecraft.init.Items;
import org.lwjgl.input.Keyboard;

public class TickListener extends EventListener<TickEvent, ChorusManipulator> {

    public TickListener(final ChorusManipulator chorusManipulator) {
        super(TickEvent.class, chorusManipulator);
    }

    @Override
    public void invoke(final Object object) {
        if (!(mc.player.getHeldItemMainhand().getItem().equals(Items.CHORUS_FRUIT) && mc.gameSettings.keyBindUseItem.isKeyDown())) {
            module.timer.syncTime();
        }
        if (module.timer.getTime(500)) {
            module.chorussed = true;
        }
        if (module.chorussed && Keyboard.isKeyDown(module.activateKey.GetKey())) {
            Main.newBus.unregisterListeners(new TickListener[]{this});
            module.setEnabled(false);
            module.onDisable();
            Main.newBus.registerListeners(new TickListener[]{this});
            module.setEnabled(true);
            module.onEnable();
            Main.chatManager.sendRemovableMessage("Teleported to chorus position", 1);
        }
    }
}
