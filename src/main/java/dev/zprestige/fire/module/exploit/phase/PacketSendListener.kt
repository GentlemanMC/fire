package dev.zprestige.fire.module.exploit.phase

import dev.zprestige.fire.event.bus.EventListener
import dev.zprestige.fire.event.impl.PacketEvent.PacketSendEvent
import net.minecraft.network.play.client.CPacketPlayer

class PacketSendListener(phase: Phase) : EventListener<PacketSendEvent, Phase>(PacketSendEvent::class.java, phase) {
    
    override fun invoke(e: Any) {
        val event = e as PacketSendEvent
        if (event.packet is CPacketPlayer) {
            val packet = event.packet as CPacketPlayer
            if (module.cPacketPlayerSet.contains(packet)) {
                module.cPacketPlayerSet.remove(packet)
                return
            }
            event.setCancelled()
        }
    }
}